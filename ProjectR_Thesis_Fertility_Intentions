# Thesis_Fertility_Intentions

# Code for the new project I started in R

getwd()
list.files()
setwd("/Users/rashisingh/Thesis_Fertility_Intentions")
data <- read.csv("/Users/rashisingh/Thesis_Fertility_Intentions/Survey_1_cleaned.csv")

#Visualizing Columns for reference
ClimateConcern <- data[, c("Q41_T0", "Q43_T1")]
IdealChildren_Society <- data[, c("Q50_T0_MOD", "Q52_MOD_T1")]
IdealChildren_Personally <- data[, c("Q51_T0", "Q53_MOD_T1")]

#Combining Columns of T0 & T1 

data$Concern_Combined <- paste(data$Q41_T0, data$Q43_T1)
data$Ideal_Children_Society <- paste(data$Q50_T0_MOD, data$Q53_MOD_T1) 
data$Ideal_Children_Personally <- paste(data$Q51_T0, data$Q53_MOD_T1)
View(data)

 # Converting data to lowercase for easier pattern 
data$Concern_Combined_clean <- tolower(data$Concern_Combined)
View(data)
library(dplyr)
library(stringr)

#Categorising data
data$Concern_Category <- case_when(
  str_detect(data$Concern_Combined_clean, "not at all concerned|unconcerned") ~ "UNCONCERNED",
  str_detect(data$Concern_Combined_clean, "fairly concerned") ~ "CONCERNED",
  str_detect(data$Concern_Combined_clean, "very concerned") ~ "VERY CONCERNED",
  str_detect(data$Concern_Combined_clean, "extremely concerned") ~ "EXTREMELY CONCERNED",
  TRUE ~ NA_character_
)

 # Checking NA after categorization step

sum(is.na(data$Concern_Category)) 
library(ggplot2)

# plot without percentage
library(ggplot2)
ggplot(data, aes(x = Concern_Category)) +
  geom_bar(fill = "steelblue") +
  labs(title = "Levels of Climate Change Concern",
       x = "Concern Category",
       y = "Number of Respondents") +
  theme_minimal() +
  theme(axis.text.x = element_text(angle = 30, hjust = 1),
        plot.title = element_text(hjust = 0.5))


# plot with percentage 

# Calculate the count and percentage for each category
category_counts <- data %>%
  count(Concern_Category) %>%
  mutate(percentage = n / sum(n) * 100)

# Calculate the count and percentage for each category
category_counts <- data %>%
  count(Concern_Category) %>%
  mutate(percentage = n / sum(n) * 100)

# Plot the bar chart with percentages
ggplot(category_counts, aes(x = Concern_Category, y = percentage)) +
  geom_bar(stat = "identity", fill = "steelblue") +
  geom_text(aes(label = paste0(round(percentage, 1), "%")), vjust = -0.5) +
  labs(title = "Levels of Climate Change Concern",
       x = "Concern Category",
       y = "Percentage of Respondents") +
  theme_minimal() +
  theme(axis.text.x = element_text(angle = 30, hjust = 1),
        plot.title = element_text(hjust = 0.5))

